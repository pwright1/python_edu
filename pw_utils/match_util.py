
# Copyright Aug 2025, Philip Wright. All rights reserved. 

import re
import numpy

class MatchUtil:
    def __init__(self):
        self.abbrevMap = {}
        self.abbrevMap["ALLEE"] = "ALY"
        self.abbrevMap["ALLEY"] = "ALY"
        self.abbrevMap["ALLY"] = "ALY"
        self.abbrevMap["ALY"] = "ALY"
        self.abbrevMap["ANEX"] = "ANX"
        self.abbrevMap["ANNEX"] = "ANX"
        self.abbrevMap["ANNX"] = "ANX"
        self.abbrevMap["ANX"] = "ANX"
        self.abbrevMap["ARC"] = "ARC"
        self.abbrevMap["ARCADE"] = "ARC"
        self.abbrevMap["AV"] = "AVE"
        self.abbrevMap["AVE"] = "AVE"
        self.abbrevMap["AVEN"] = "AVE"
        self.abbrevMap["AVENU"] = "AVE"
        self.abbrevMap["AVENUE"] = "AVE"
        self.abbrevMap["AVN"] = "AVE"
        self.abbrevMap["AVNUE"] = "AVE"
        self.abbrevMap["BAYOO"] = "BYU"
        self.abbrevMap["BAYOU"] = "BYU"
        self.abbrevMap["BCH"] = "BCH"
        self.abbrevMap["BEACH"] = "BCH"
        self.abbrevMap["BEND"] = "BND"
        self.abbrevMap["BLF"] = "BLF"
        self.abbrevMap["BLUF"] = "BLF"
        self.abbrevMap["BLUFF"] = "BLF"
        self.abbrevMap["BLUFFS"] = "BLFS"
        self.abbrevMap["BLVD"] = "BLVD"
        self.abbrevMap["BND"] = "BND"
        self.abbrevMap["BOT"] = "BTM"
        self.abbrevMap["BOTTM"] = "BTM"
        self.abbrevMap["BOTTOM"] = "BTM"
        self.abbrevMap["BOUL"] = "BLVD"
        self.abbrevMap["BOULEVARD"] = "BLVD"
        self.abbrevMap["BOULV"] = "BLVD"
        self.abbrevMap["BR"] = "BR"
        self.abbrevMap["BRANCH"] = "BR"
        self.abbrevMap["BRDGE"] = "BRG"
        self.abbrevMap["BRG"] = "BRG"
        self.abbrevMap["BRIDGE"] = "BRG"
        self.abbrevMap["BRK"] = "BRK"
        self.abbrevMap["BRNCH"] = "BR"
        self.abbrevMap["BROOK"] = "BRK"
        self.abbrevMap["BROOKS"] = "BRKS"
        self.abbrevMap["BTM"] = "BTM"
        self.abbrevMap["BURG"] = "BG"
        self.abbrevMap["BURGS"] = "BGS"
        self.abbrevMap["BYP"] = "BYP"
        self.abbrevMap["BYPA"] = "BYP"
        self.abbrevMap["BYPAS"] = "BYP"
        self.abbrevMap["BYPASS"] = "BYP"
        self.abbrevMap["BYPS"] = "BYP"
        self.abbrevMap["CAMP"] = "CP"
        self.abbrevMap["CANYN"] = "CYN"
        self.abbrevMap["CANYON"] = "CYN"
        self.abbrevMap["CAPE"] = "CPE"
        self.abbrevMap["CAUSEWAY"] = "CSWY"
        self.abbrevMap["CAUSWAY"] = "CSWY"
        self.abbrevMap["CEN"] = "CTR"
        self.abbrevMap["CENT"] = "CTR"
        self.abbrevMap["CENTER"] = "CTR"
        self.abbrevMap["CENTERS"] = "CTRS"
        self.abbrevMap["CENTR"] = "CTR"
        self.abbrevMap["CENTRE"] = "CTR"
        self.abbrevMap["CIR"] = "CIR"
        self.abbrevMap["CIRC"] = "CIR"
        self.abbrevMap["CIRCL"] = "CIR"
        self.abbrevMap["CIRCLE"] = "CIR"
        self.abbrevMap["CIRCLES"] = "CIRS"
        self.abbrevMap["CK"] = "CRK"
        self.abbrevMap["CLB"] = "CLB"
        self.abbrevMap["CLF"] = "CLF"
        self.abbrevMap["CLFS"] = "CLFS"
        self.abbrevMap["CLIFF"] = "CLF"
        self.abbrevMap["CLIFFS"] = "CLFS"
        self.abbrevMap["CLUB"] = "CLB"
        self.abbrevMap["CMP"] = "CP"
        self.abbrevMap["CNTER"] = "CTR"
        self.abbrevMap["CNTR"] = "CTR"
        self.abbrevMap["CNYN"] = "CYN"
        self.abbrevMap["COMMON"] = "CMN"
        self.abbrevMap["COR"] = "COR"
        self.abbrevMap["CORNER"] = "COR"
        self.abbrevMap["CORNERS"] = "CORS"
        self.abbrevMap["CORS"] = "CORS"
        self.abbrevMap["COURSE"] = "CRSE"
        self.abbrevMap["COURT"] = "CT"
        self.abbrevMap["COURTS"] = "CTS"
        self.abbrevMap["COVE"] = "CV"
        self.abbrevMap["COVES"] = "CVS"
        self.abbrevMap["CP"] = "CP"
        self.abbrevMap["CPE"] = "CPE"
        self.abbrevMap["CR"] = "CRK"
        self.abbrevMap["CRCL"] = "CIR"
        self.abbrevMap["CRCLE"] = "CIR"
        self.abbrevMap["CRECENT"] = "CRES"
        self.abbrevMap["CREEK"] = "CRK"
        self.abbrevMap["CRES"] = "CRES"
        self.abbrevMap["CRESCENT"] = "CRES"
        self.abbrevMap["CRESENT"] = "CRES"
        self.abbrevMap["CREST"] = "CRST"
        self.abbrevMap["CRK"] = "CRK"
        self.abbrevMap["CROSSING"] = "XING"
        self.abbrevMap["CROSSROAD"] = "XRD"
        self.abbrevMap["CRSCNT"] = "CRES"
        self.abbrevMap["CRSE"] = "CRSE"
        self.abbrevMap["CRSENT"] = "CRES"
        self.abbrevMap["CRSNT"] = "CRES"
        self.abbrevMap["CRSSING"] = "XING"
        self.abbrevMap["CRSSNG"] = "XING"
        self.abbrevMap["CRT"] = "CT"
        self.abbrevMap["CSWY"] = "CSWY"
        self.abbrevMap["CT"] = "CT"
        self.abbrevMap["CTR"] = "CTR"
        self.abbrevMap["CURVE"] = "CURV"
        self.abbrevMap["CV"] = "CV"
        self.abbrevMap["CYN"] = "CYN"
        self.abbrevMap["DALE"] = "DL"
        self.abbrevMap["DAM"] = "DM"
        self.abbrevMap["DIV"] = "DV"
        self.abbrevMap["DIVIDE"] = "DV"
        self.abbrevMap["DL"] = "DL"
        self.abbrevMap["DM"] = "DM"
        self.abbrevMap["DR"] = "DR"
        self.abbrevMap["DRIV"] = "DR"
        self.abbrevMap["DRIVE"] = "DR"
        self.abbrevMap["DRIVES"] = "DRS"
        self.abbrevMap["DRV"] = "DR"
        self.abbrevMap["DV"] = "DV"
        self.abbrevMap["DVD"] = "DV"
        self.abbrevMap["EST"] = "EST"
        self.abbrevMap["ESTATE"] = "EST"
        self.abbrevMap["ESTATES"] = "ESTS"
        self.abbrevMap["ESTS"] = "ESTS"
        self.abbrevMap["EXP"] = "EXPY"
        self.abbrevMap["EXPR"] = "EXPY"
        self.abbrevMap["EXPRESS"] = "EXPY"
        self.abbrevMap["EXPRESSWAY"] = "EXPY"
        self.abbrevMap["EXPW"] = "EXPY"
        self.abbrevMap["EXPY"] = "EXPY"
        self.abbrevMap["EXT"] = "EXT"
        self.abbrevMap["EXTENSION"] = "EXT"
        self.abbrevMap["EXTENSIONS"] = "EXTS"
        self.abbrevMap["EXTN"] = "EXT"
        self.abbrevMap["EXTNSN"] = "EXT"
        self.abbrevMap["EXTS"] = "EXTS"
        self.abbrevMap["FALL"] = "FALL"
        self.abbrevMap["FALLS"] = "FLS"
        self.abbrevMap["FERRY"] = "FRY"
        self.abbrevMap["FIELD"] = "FLD"
        self.abbrevMap["FIELDS"] = "FLDS"
        self.abbrevMap["FLAT"] = "FLT"
        self.abbrevMap["FLATS"] = "FLTS"
        self.abbrevMap["FLD"] = "FLD"
        self.abbrevMap["FLDS"] = "FLDS"
        self.abbrevMap["FLS"] = "FLS"
        self.abbrevMap["FLT"] = "FLT"
        self.abbrevMap["FLTS"] = "FLTS"
        self.abbrevMap["FORD"] = "FRD"
        self.abbrevMap["FORDS"] = "FRDS"
        self.abbrevMap["FOREST"] = "FRST"
        self.abbrevMap["FORESTS"] = "FRST"
        self.abbrevMap["FORG"] = "FRG"
        self.abbrevMap["FORGE"] = "FRG"
        self.abbrevMap["FORGES"] = "FRGS"
        self.abbrevMap["FORK"] = "FRK"
        self.abbrevMap["FORKS"] = "FRKS"
        self.abbrevMap["FORT"] = "FT"
        self.abbrevMap["FRD"] = "FRD"
        self.abbrevMap["FREEWAY"] = "FWY"
        self.abbrevMap["FREEWY"] = "FWY"
        self.abbrevMap["FRG"] = "FRG"
        self.abbrevMap["FRK"] = "FRK"
        self.abbrevMap["FRKS"] = "FRKS"
        self.abbrevMap["FRRY"] = "FRY"
        self.abbrevMap["FRST"] = "FRST"
        self.abbrevMap["FRT"] = "FT"
        self.abbrevMap["FRWAY"] = "FWY"
        self.abbrevMap["FRWY"] = "FWY"
        self.abbrevMap["FRY"] = "FRY"
        self.abbrevMap["FT"] = "FT"
        self.abbrevMap["FWY"] = "FWY"
        self.abbrevMap["GARDEN"] = "GDN"
        self.abbrevMap["GARDENS"] = "GDNS"
        self.abbrevMap["GARDN"] = "GDN"
        self.abbrevMap["GATEWAY"] = "GTWY"
        self.abbrevMap["GATEWY"] = "GTWY"
        self.abbrevMap["GATWAY"] = "GTWY"
        self.abbrevMap["GDN"] = "GDN"
        self.abbrevMap["GDNS"] = "GDNS"
        self.abbrevMap["GLEN"] = "GLN"
        self.abbrevMap["GLENS"] = "GLNS"
        self.abbrevMap["GLN"] = "GLN"
        self.abbrevMap["GRDEN"] = "GDN"
        self.abbrevMap["GRDN"] = "GDN"
        self.abbrevMap["GRDNS"] = "GDNS"
        self.abbrevMap["GREEN"] = "GRN"
        self.abbrevMap["GREENS"] = "GRNS"
        self.abbrevMap["GRN"] = "GRN"
        self.abbrevMap["GROV"] = "GRV"
        self.abbrevMap["GROVE"] = "GRV"
        self.abbrevMap["GROVES"] = "GRVS"
        self.abbrevMap["GRV"] = "GRV"
        self.abbrevMap["GTWAY"] = "GTWY"
        self.abbrevMap["GTWY"] = "GTWY"
        self.abbrevMap["HARB"] = "HBR"
        self.abbrevMap["HARBOR"] = "HBR"
        self.abbrevMap["HARBORS"] = "HBRS"
        self.abbrevMap["HARBR"] = "HBR"
        self.abbrevMap["HAVEN"] = "HVN"
        self.abbrevMap["HAVN"] = "HVN"
        self.abbrevMap["HBR"] = "HBR"
        self.abbrevMap["HEIGHT"] = "HTS"
        self.abbrevMap["HEIGHTS"] = "HTS"
        self.abbrevMap["HGTS"] = "HTS"
        self.abbrevMap["HIGHWAY"] = "HWY"
        self.abbrevMap["HIGHWY"] = "HWY"
        self.abbrevMap["HILL"] = "HL"
        self.abbrevMap["HILLS"] = "HLS"
        self.abbrevMap["HIWAY"] = "HWY"
        self.abbrevMap["HIWY"] = "HWY"
        self.abbrevMap["HL"] = "HL"
        self.abbrevMap["HLLW"] = "HOLW"
        self.abbrevMap["HLS"] = "HLS"
        self.abbrevMap["HOLLOW"] = "HOLW"
        self.abbrevMap["HOLLOWS"] = "HOLW"
        self.abbrevMap["HOLW"] = "HOLW"
        self.abbrevMap["HOLWS"] = "HOLW"
        self.abbrevMap["HRBOR"] = "HBR"
        self.abbrevMap["HT"] = "HTS"
        self.abbrevMap["HTS"] = "HTS"
        self.abbrevMap["HVN"] = "HVN"
        self.abbrevMap["HWAY"] = "HWY"
        self.abbrevMap["HWY"] = "HWY"
        self.abbrevMap["INLET"] = "INLT"
        self.abbrevMap["INLT"] = "INLT"
        self.abbrevMap["IS"] = "IS"
        self.abbrevMap["ISLAND"] = "IS"
        self.abbrevMap["ISLANDS"] = "ISS"
        self.abbrevMap["ISLE"] = "ISLE"
        self.abbrevMap["ISLES"] = "ISLE"
        self.abbrevMap["ISLND"] = "IS"
        self.abbrevMap["ISLNDS"] = "ISS"
        self.abbrevMap["ISS"] = "ISS"
        self.abbrevMap["JCT"] = "JCT"
        self.abbrevMap["JCTION"] = "JCT"
        self.abbrevMap["JCTN"] = "JCT"
        self.abbrevMap["JCTNS"] = "JCTS"
        self.abbrevMap["JCTS"] = "JCTS"
        self.abbrevMap["JUNCTION"] = "JCT"
        self.abbrevMap["JUNCTIONS"] = "JCTS"
        self.abbrevMap["JUNCTN"] = "JCT"
        self.abbrevMap["JUNCTON"] = "JCT"
        self.abbrevMap["KEY"] = "KY"
        self.abbrevMap["KEYS"] = "KYS"
        self.abbrevMap["KNL"] = "KNL"
        self.abbrevMap["KNLS"] = "KNLS"
        self.abbrevMap["KNOL"] = "KNL"
        self.abbrevMap["KNOLL"] = "KNL"
        self.abbrevMap["KNOLLS"] = "KNLS"
        self.abbrevMap["KY"] = "KY"
        self.abbrevMap["KYS"] = "KYS"
        self.abbrevMap["LA"] = "LN"
        self.abbrevMap["LAKE"] = "LK"
        self.abbrevMap["LAKES"] = "LKS"
        self.abbrevMap["LAND"] = "LAND"
        self.abbrevMap["LANDING"] = "LNDG"
        self.abbrevMap["LANE"] = "LN"
        self.abbrevMap["LANES"] = "LN"
        self.abbrevMap["LCK"] = "LCK"
        self.abbrevMap["LCKS"] = "LCKS"
        self.abbrevMap["LDG"] = "LDG"
        self.abbrevMap["LDGE"] = "LDG"
        self.abbrevMap["LF"] = "LF"
        self.abbrevMap["LGT"] = "LGT"
        self.abbrevMap["LIGHT"] = "LGT"
        self.abbrevMap["LIGHTS"] = "LGTS"
        self.abbrevMap["LK"] = "LK"
        self.abbrevMap["LKS"] = "LKS"
        self.abbrevMap["LN"] = "LN"
        self.abbrevMap["LNDG"] = "LNDG"
        self.abbrevMap["LNDNG"] = "LNDG"
        self.abbrevMap["LOAF"] = "LF"
        self.abbrevMap["LOCK"] = "LCK"
        self.abbrevMap["LOCKS"] = "LCKS"
        self.abbrevMap["LODG"] = "LDG"
        self.abbrevMap["LODGE"] = "LDG"
        self.abbrevMap["LOOP"] = "LOOP"
        self.abbrevMap["LOOPS"] = "LOOP"
        self.abbrevMap["MALL"] = "MALL"
        self.abbrevMap["MANOR"] = "MNR"
        self.abbrevMap["MANORS"] = "MNRS"
        self.abbrevMap["MDW"] = "MDW"
        self.abbrevMap["MDWS"] = "MDWS"
        self.abbrevMap["MEADOW"] = "MDW"
        self.abbrevMap["MEADOWS"] = "MDWS"
        self.abbrevMap["MEDOWS"] = "MDWS"
        self.abbrevMap["MEWS"] = "MEWS"
        self.abbrevMap["MILL"] = "ML"
        self.abbrevMap["MILLS"] = "MLS"
        self.abbrevMap["MISSION"] = "MSN"
        self.abbrevMap["MISSN"] = "MSN"
        self.abbrevMap["ML"] = "ML"
        self.abbrevMap["MLS"] = "MLS"
        self.abbrevMap["MNR"] = "MNR"
        self.abbrevMap["MNRS"] = "MNRS"
        self.abbrevMap["MNT"] = "MT"
        self.abbrevMap["MNTAIN"] = "MTN"
        self.abbrevMap["MNTN"] = "MTN"
        self.abbrevMap["MNTNS"] = "MTNS"
        self.abbrevMap["MOTORWAY"] = "MTWY"
        self.abbrevMap["MOUNT"] = "MT"
        self.abbrevMap["MOUNTAIN"] = "MTN"
        self.abbrevMap["MOUNTAINS"] = "MTNS"
        self.abbrevMap["MOUNTIN"] = "MTN"
        self.abbrevMap["MSN"] = "MSN"
        self.abbrevMap["MSSN"] = "MSN"
        self.abbrevMap["MT"] = "MT"
        self.abbrevMap["MTIN"] = "MTN"
        self.abbrevMap["MTN"] = "MTN"
        self.abbrevMap["NCK"] = "NCK"
        self.abbrevMap["NECK"] = "NCK"
        self.abbrevMap["ORCH"] = "ORCH"
        self.abbrevMap["ORCHARD"] = "ORCH"
        self.abbrevMap["ORCHRD"] = "ORCH"
        self.abbrevMap["OVAL"] = "OVAL"
        self.abbrevMap["OVERPASS"] = "OPAS"
        self.abbrevMap["OVL"] = "OVAL"
        self.abbrevMap["PARK"] = "PARK"
        self.abbrevMap["PARKS"] = "PARK"
        self.abbrevMap["PARKWAY"] = "PKWY"
        self.abbrevMap["PARKWAYS"] = "PKWY"
        self.abbrevMap["PARKWY"] = "PKWY"
        self.abbrevMap["PASS"] = "PASS"
        self.abbrevMap["PASSAGE"] = "PSGE"
        self.abbrevMap["PATH"] = "PATH"
        self.abbrevMap["PATHS"] = "PATH"
        self.abbrevMap["PIKE"] = "PIKE"
        self.abbrevMap["PIKES"] = "PIKE"
        self.abbrevMap["PINE"] = "PNE"
        self.abbrevMap["PINES"] = "PNES"
        self.abbrevMap["PK"] = "PARK"
        self.abbrevMap["PKWAY"] = "PKWY"
        self.abbrevMap["PKWY"] = "PKWY"
        self.abbrevMap["PKWYS"] = "PKWY"
        self.abbrevMap["PKY"] = "PKWY"
        self.abbrevMap["PL"] = "PL"
        self.abbrevMap["PLACE"] = "PL"
        self.abbrevMap["PLAIN"] = "PLN"
        self.abbrevMap["PLAINES"] = "PLNS"
        self.abbrevMap["PLAINS"] = "PLNS"
        self.abbrevMap["PLAZA"] = "PLZ"
        self.abbrevMap["PLN"] = "PLN"
        self.abbrevMap["PLNS"] = "PLNS"
        self.abbrevMap["PLZ"] = "PLZ"
        self.abbrevMap["PLZA"] = "PLZ"
        self.abbrevMap["PNES"] = "PNES"
        self.abbrevMap["POINT"] = "PT"
        self.abbrevMap["POINTS"] = "PTS"
        self.abbrevMap["PORT"] = "PRT"
        self.abbrevMap["PORTS"] = "PRTS"
        self.abbrevMap["PR"] = "PR"
        self.abbrevMap["PRAIRIE"] = "PR"
        self.abbrevMap["PRARIE"] = "PR"
        self.abbrevMap["PRK"] = "PARK"
        self.abbrevMap["PRR"] = "PR"
        self.abbrevMap["PRT"] = "PRT"
        self.abbrevMap["PRTS"] = "PRTS"
        self.abbrevMap["PT"] = "PT"
        self.abbrevMap["PTS"] = "PTS"
        self.abbrevMap["RAD"] = "RADL"
        self.abbrevMap["RADIAL"] = "RADL"
        self.abbrevMap["RADIEL"] = "RADL"
        self.abbrevMap["RADL"] = "RADL"
        self.abbrevMap["RAMP"] = "RAMP"
        self.abbrevMap["RANCH"] = "RNCH"
        self.abbrevMap["RANCHES"] = "RNCH"
        self.abbrevMap["RAPID"] = "RPD"
        self.abbrevMap["RAPIDS"] = "RPDS"
        self.abbrevMap["RD"] = "RD"
        self.abbrevMap["RDG"] = "RDG"
        self.abbrevMap["RDGE"] = "RDG"
        self.abbrevMap["RDGS"] = "RDGS"
        self.abbrevMap["RDS"] = "RDS"
        self.abbrevMap["REST"] = "RST"
        self.abbrevMap["RIDGE"] = "RDG"
        self.abbrevMap["RIDGES"] = "RDGS"
        self.abbrevMap["RIV"] = "RIV"
        self.abbrevMap["RIVER"] = "RIV"
        self.abbrevMap["RIVR"] = "RIV"
        self.abbrevMap["RNCH"] = "RNCH"
        self.abbrevMap["RNCHS"] = "RNCH"
        self.abbrevMap["ROAD"] = "RD"
        self.abbrevMap["ROADS"] = "RDS"
        self.abbrevMap["ROUTE"] = "RTE"
        self.abbrevMap["ROW"] = "ROW"
        self.abbrevMap["RPD"] = "RPD"
        self.abbrevMap["RPDS"] = "RPDS"
        self.abbrevMap["RST"] = "RST"
        self.abbrevMap["RUE"] = "RUE"
        self.abbrevMap["RUN"] = "RUN"
        self.abbrevMap["RVR"] = "RIV"
        self.abbrevMap["SHL"] = "SHL"
        self.abbrevMap["SHLS"] = "SHLS"
        self.abbrevMap["SHOAL"] = "SHL"
        self.abbrevMap["SHOALS"] = "SHLS"
        self.abbrevMap["SHOAR"] = "SHR"
        self.abbrevMap["SHOARS"] = "SHRS"
        self.abbrevMap["SHORE"] = "SHR"
        self.abbrevMap["SHORES"] = "SHRS"
        self.abbrevMap["SHR"] = "SHR"
        self.abbrevMap["SHRS"] = "SHRS"
        self.abbrevMap["SKYWAY"] = "SKWY"
        self.abbrevMap["SMT"] = "SMT"
        self.abbrevMap["SPG"] = "SPG"
        self.abbrevMap["SPGS"] = "SPGS"
        self.abbrevMap["SPNG"] = "SPG"
        self.abbrevMap["SPNGS"] = "SPGS"
        self.abbrevMap["SPRING"] = "SPG"
        self.abbrevMap["SPRINGS"] = "SPGS"
        self.abbrevMap["SPRNG"] = "SPG"
        self.abbrevMap["SPRNGS"] = "SPGS"
        self.abbrevMap["SPUR"] = "SPUR"
        self.abbrevMap["SPURS"] = "SPUR"
        self.abbrevMap["SQ"] = "SQ"
        self.abbrevMap["SQR"] = "SQ"
        self.abbrevMap["SQRE"] = "SQ"
        self.abbrevMap["SQRS"] = "SQS"
        self.abbrevMap["SQU"] = "SQ"
        self.abbrevMap["SQUARE"] = "SQ"
        self.abbrevMap["SQUARES"] = "SQS"
        self.abbrevMap["ST"] = "ST"
        self.abbrevMap["STA"] = "STA"
        self.abbrevMap["STATION"] = "STA"
        self.abbrevMap["STATN"] = "STA"
        self.abbrevMap["STN"] = "STA"
        self.abbrevMap["STR"] = "ST"
        self.abbrevMap["STRA"] = "STRA"
        self.abbrevMap["STRAV"] = "STRA"
        self.abbrevMap["STRAVE"] = "STRA"
        self.abbrevMap["STRAVEN"] = "STRA"
        self.abbrevMap["STRAVENUE"] = "STRA"
        self.abbrevMap["STRAVN"] = "STRA"
        self.abbrevMap["STREAM"] = "STRM"
        self.abbrevMap["STREET"] = "ST"
        self.abbrevMap["STREETS"] = "STS"
        self.abbrevMap["STREME"] = "STRM"
        self.abbrevMap["STRM"] = "STRM"
        self.abbrevMap["STRT"] = "ST"
        self.abbrevMap["STRVN"] = "STRA"
        self.abbrevMap["STRVNUE"] = "STRA"
        self.abbrevMap["SUMIT"] = "SMT"
        self.abbrevMap["SUMITT"] = "SMT"
        self.abbrevMap["SUMMIT"] = "SMT"
        self.abbrevMap["TER"] = "TER"
        self.abbrevMap["TERR"] = "TER"
        self.abbrevMap["TERRACE"] = "TER"
        self.abbrevMap["THROUGHWAY"] = "TRWY"
        self.abbrevMap["TPK"] = "TPKE"
        self.abbrevMap["TPKE"] = "TPKE"
        self.abbrevMap["TR"] = "TRL"
        self.abbrevMap["TRACE"] = "TRCE"
        self.abbrevMap["TRACES"] = "TRCE"
        self.abbrevMap["TRACK"] = "TRAK"
        self.abbrevMap["TRACKS"] = "TRAK"
        self.abbrevMap["TRAFFICWAY"] = "TRFY"
        self.abbrevMap["TRAIL"] = "TRL"
        self.abbrevMap["TRAILS"] = "TRL"
        self.abbrevMap["TRAK"] = "TRAK"
        self.abbrevMap["TRCE"] = "TRCE"
        self.abbrevMap["TRFY"] = "TRFY"
        self.abbrevMap["TRK"] = "TRAK"
        self.abbrevMap["TRKS"] = "TRAK"
        self.abbrevMap["TRL"] = "TRL"
        self.abbrevMap["TRLS"] = "TRL"
        self.abbrevMap["TRNPK"] = "TPKE"
        self.abbrevMap["TRPK"] = "TPKE"
        self.abbrevMap["TUNEL"] = "TUNL"
        self.abbrevMap["TUNL"] = "TUNL"
        self.abbrevMap["TUNLS"] = "TUNL"
        self.abbrevMap["TUNNEL"] = "TUNL"
        self.abbrevMap["TUNNELS"] = "TUNL"
        self.abbrevMap["TUNNL"] = "TUNL"
        self.abbrevMap["TURNPIKE"] = "TPKE"
        self.abbrevMap["TURNPK"] = "TPKE"
        self.abbrevMap["UN"] = "UN"
        self.abbrevMap["UNDERPASS"] = "UPAS"
        self.abbrevMap["UNION"] = "UN"
        self.abbrevMap["UNIONS"] = "UNS"
        self.abbrevMap["VALLEY"] = "VLY"
        self.abbrevMap["VALLEYS"] = "VLYS"
        self.abbrevMap["VALLY"] = "VLY"
        self.abbrevMap["VDCT"] = "VIA"
        self.abbrevMap["VIA"] = "VIA"
        self.abbrevMap["VIADCT"] = "VIA"
        self.abbrevMap["VIADUCT"] = "VIA"
        self.abbrevMap["VIEW"] = "VW"
        self.abbrevMap["VIEWS"] = "VWS"
        self.abbrevMap["VILL"] = "VLG"
        self.abbrevMap["VILLAG"] = "VLG"
        self.abbrevMap["VILLAGE"] = "VLG"
        self.abbrevMap["VILLAGES"] = "VLGS"
        self.abbrevMap["VILLE"] = "VL"
        self.abbrevMap["VILLG"] = "VLG"
        self.abbrevMap["VILLIAGE"] = "VLG"
        self.abbrevMap["VIS"] = "VIS"
        self.abbrevMap["VIST"] = "VIS"
        self.abbrevMap["VISTA"] = "VIS"
        self.abbrevMap["VL"] = "VL"
        self.abbrevMap["VLG"] = "VLG"
        self.abbrevMap["VLGS"] = "VLGS"
        self.abbrevMap["VLLY"] = "VLY"
        self.abbrevMap["VLY"] = "VLY"
        self.abbrevMap["VLYS"] = "VLYS"
        self.abbrevMap["VST"] = "VIS"
        self.abbrevMap["VSTA"] = "VIS"
        self.abbrevMap["VW"] = "VW"
        self.abbrevMap["VWS"] = "VWS"
        self.abbrevMap["WALK"] = "WALK"
        self.abbrevMap["WALKS"] = "WALK"
        self.abbrevMap["WALL"] = "WALL"
        self.abbrevMap["WAY"] = "WAY"
        self.abbrevMap["WAYS"] = "WAYS"
        self.abbrevMap["WELL"] = "WL"
        self.abbrevMap["WELLS"] = "WLS"
        self.abbrevMap["WLS"] = "WLS"
        self.abbrevMap["WY"] = "WAY"
        self.abbrevMap["XING"] = "XING"
        pass # def init

        
    def abbrev_translate(self, string):
        result = ""
        try:
            result = self.abbrevMap[string]
        except KeyError as err:
            # hash fails lookup
            return string
        return result
    
    def normalize(self, string):
        outstring = re.sub(r"\s",r"",str(string))
        outstring = re.sub(r"'",r"", outstring)
        return outstring

    def parse_address_careful(self, val):
        outstring1 = re.sub(r"\.",r"",str(val))
        outstring2 = re.sub(r"\"",r"",outstring1)
        outstring3 = re.sub(r"\s+",r" ",outstring2)
        outstring4 = re.sub(r",",r"",outstring3)
        fields = outstring4.split(" ")
        accum = []
        for field in fields:
            trans = self.abbrev_translate(field)
            accum.append(trans)
        result = " ".join(accum)
        return result

    def has_numeric(self, string):
        the_len = len(string)
        i = 0
        done = False
        while not done and i < the_len:
            part = string[i:i+1]
            if part <= "9" and part >= "0":
                done = True
            i += 1
        return done
        
    def email_compare(self, e1, e2):
        e1s = e1.upper()
        e2s = e2.upper()
        if len(e1s) == 0 or len(e2s) == 0 or e1s == "NOT@GIVEN" or e2s == "NOT@GIVEN":
            return False
        if e1s == e2s and len(e1s) > 0:
            return True
        return False
    
    def phone_cleanup(self, string):
        outstring1 = re.sub(r"\s", r"", str(string))
        outstring2 = re.sub(r"\-", r"", outstring1)
        outstring3 = re.sub(r"\/", r"", outstring2)
        outstring4 = re.sub(r"\(", r"", outstring3)
        outstring5 = re.sub(r"\)", r"", outstring4)
        return outstring5
    
    def phone_compare(self, p1, p2):
        p1s = self.phone_cleanup(str(p1))
        p2s = self.phone_cleanup(str(p2))
        if len(p1s) > 4 and len(p2s) > 4 and str(p1s) == str(p2s):
            return True
        
        if p1s != "" and len(p1s) > 4 and p2s != "" and len(p2s) > 4:
            lcs = self.longest_common_substring(p1s, p2s)
            if len(lcs) >= 10:
                return True
        return False
        
    def longest_common_substring(self,s1, s2):
        # see wikibooks
        if s1 == "" or s2 == "":
            return ""
        s1_len = len(s1)
        s2_len = len(s2)
        m = numpy.zeros((s1_len, s2_len))
        longest_length = 0
        longest_end_pos = 0
        for x in range(s1_len):
            for y in range(s2_len):
                if s1[x] == s2[y]:
                    m[x,y] = 1
                    if x> 0 and y > 0:
                        m[x,y] += m[x-1,y-1]
                    if m[x,y] > longest_length:
                        longest_length = m[x,y]
                        longest_end_pos = x
        i0 = int(longest_end_pos - longest_length + 1)
        i1 = int(longest_end_pos + 1)
        return s1[i0:i1]
    
